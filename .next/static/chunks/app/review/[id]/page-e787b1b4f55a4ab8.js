(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[536],{6926:function(e,s,n){Promise.resolve().then(n.bind(n,7330))},7330:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return b}});var i=n(7437),l=n(1396),a=n.n(l),t=n(2615),r=n(6716),c=n(1279),o=n(1988),d=n(2759),m=n(4883),h=n(2265),u=n(2749),x=n(9222),v=n(6525);function j(e){let{id:s}=e,[n,l]=(0,h.useState)(""),[o,d]=(0,h.useState)(""),{data:j,isLoading:p,error:g}=(0,v.ZP)("/api/comment",async()=>{let e=await x.Z.get("/api/comment/".concat(s));return e.data},{refreshInterval:1e3}),{data:N}=(0,u.useSession)();if(g)return console.log(g),(0,i.jsx)("p",{children:"Something went wrong. Try to reload page"});if(p)return(0,i.jsx)("p",{children:"Loading comments..."});if((null==j?void 0:j.length)===0)return(0,i.jsx)("div",{className:"shadow py-5 px-1 rounded",children:(0,i.jsx)("h5",{className:"m-0 ms-5",children:"No comments yet"})});let f=(e,s)=>{l(e),d(s)},w=async()=>{d(""),l("")},y={comment:o,reviewId:s},Z=async()=>{await x.Z.post("/api/comment/edit/".concat(n),y),d(""),l("")},b=async e=>{let s=await x.Z.delete("/api/comment/delete/".concat(e));console.log(s),d(""),l("")};return(0,i.jsxs)("div",{className:"shadow rounded p-3",children:[(0,i.jsx)("p",{className:"px-3",children:(0,i.jsxs)("strong",{children:[null==j?void 0:j.length," Comments"]})}),(0,i.jsxs)("div",{className:"px-3",children:[(0,i.jsx)("h4",{className:"mb-4",children:"User comments"}),(0,i.jsx)("div",{className:"px-3",children:null==j?void 0:j.map(e=>{var s,l,h;return(0,i.jsxs)("div",{className:"mb-5 row",children:[(0,i.jsxs)("div",{className:"col",children:[(0,i.jsxs)("div",{className:"row",children:[(0,i.jsx)(a(),{href:"/profile/".concat(null===(s=e.authorId)||void 0===s?void 0:s._id),className:"col text-decoration-none pt-2",children:(0,i.jsx)("strong",{children:null===(l=e.authorId)||void 0===l?void 0:l.name})}),((null==N?void 0:N.user.id)===(null===(h=e.authorId)||void 0===h?void 0:h._id)||(null==N?void 0:N.user.admin))&&(0,i.jsxs)(t.Z,{className:"col col-auto",children:[(0,i.jsx)(t.Z.Toggle,{variant:"outline-secondary",id:"dropdown-basic",children:(0,i.jsx)(c.G,{icon:"fa-solid fa-bars",className:"me-1"})}),(0,i.jsxs)(t.Z.Menu,{children:[(0,i.jsx)(t.Z.Item,{onClick:()=>f(e._id,e.comment),children:"Edit"}),(0,i.jsx)(t.Z.Divider,{}),(0,i.jsx)(t.Z.Item,{className:"text-danger",onClick:()=>b(e._id),children:"Delete"})]})]})]}),(0,i.jsx)("p",{className:"mt-3 mb-3",children:e.comment}),n===e._id&&(0,i.jsxs)(m.Z.Group,{className:"mb-3",controlId:"desc",children:[(0,i.jsxs)(m.Z.Label,{className:"d-flex justify-content-between align-items-center",children:[(0,i.jsx)("strong",{children:"Edit comment"}),(0,i.jsxs)(r.Z,{variant:"danger",onClick:w,children:[(0,i.jsx)(c.G,{icon:"fa-solid fa-xmark"})," Close"]})]}),(0,i.jsx)(m.Z.Control,{name:"comment",value:o,as:"textarea",className:"mb-3",rows:3,style:{resize:"none"},maxLength:400,placeholder:"Enter your comment",onChange:e=>d(e.target.value)}),(0,i.jsx)(r.Z,{variant:"primary",onClick:Z,children:"Edit comment"})]})]}),(0,i.jsx)("hr",{})]})})})]})]})}o.vI.add(d.xiG);var p=n(7188),g=n(517);function N(e){let{id:s,likes:n}=e,{data:l}=(0,u.useSession)(),a=async()=>{await x.Z.post("/api/review/like/".concat(s),{userId:null==l?void 0:l.user.id})},t=null==n?void 0:n.includes(null==l?void 0:l.user.id);return(0,i.jsx)("div",{className:"d-flex",children:l?(0,i.jsxs)(r.Z,{className:"ms-auto",onClick:a,children:[!t&&(0,i.jsxs)("span",{children:[(0,i.jsx)(c.G,{icon:p.m6i})," like"]}),t&&(0,i.jsxs)("span",{children:[(0,i.jsx)(c.G,{icon:d.m6i})," liked"]})]}):(0,i.jsx)(g.Z,{href:"/login",className:"ms-auto p-2 px-3 rounded text-light bg-primary",children:"Login to like this review"})})}function f(e){let{id:s}=e,[n,l]=(0,h.useState)(""),{data:t}=(0,u.useSession)(),c={comment:n,reviewId:s,authorId:null==t?void 0:t.user.id},o=async()=>{await x.Z.post("/api/comment/".concat(s),c),l("")};return(0,i.jsxs)("div",{className:"shadow p-3 rounded mb-3",children:[t&&(0,i.jsxs)(m.Z.Group,{className:"mb-3 p-3",controlId:"desc",children:[(0,i.jsx)(m.Z.Label,{children:"Your comment"}),(0,i.jsx)(m.Z.Control,{name:"commentValue",value:n,as:"textarea",className:"mb-3",rows:3,style:{resize:"none"},maxLength:400,placeholder:"Enter your comment",onChange:e=>l(e.target.value)}),(0,i.jsx)(r.Z,{variant:"primary",onClick:o,children:"Send comment"})]}),!t&&(0,i.jsx)("div",{className:"p-3",children:(0,i.jsxs)("p",{className:"m-0",children:["Only registered users can leave a comment.\xa0",(0,i.jsx)(a(),{href:"/register",className:"d-inline nav-link text-primary",children:(0,i.jsx)("strong",{children:"Sign up"})}),"\xa0or\xa0",(0,i.jsx)(a(),{href:"/login",className:"d-inline nav-link text-primary",children:(0,i.jsx)("strong",{children:"Login"})})]})})]})}var w=n(4033),y=n(9588),Z=n(1512);function b(e){var s,n,l;let{params:t}=e,{id:r}=t,c=(0,w.useRouter)(),[o,d]=(0,h.useState)([]),{data:m,error:u,isLoading:p}=(0,v.ZP)("/api/review/",async()=>{let e=await x.Z.get("http://localhost:3000"+"/api/review/".concat(r));return d(e.data.likes),e.data},{refreshInterval:1e3});return p?(0,i.jsxs)("div",{className:"vh-100",children:[" ",(0,i.jsx)(Z.Z,{})," "]}):u?(console.log(u),(0,i.jsx)("p",{children:"Something went wrong. Try to reload page"})):(m||c.push("/"),(0,i.jsxs)("div",{className:"mb-5",children:[(0,i.jsxs)("div",{className:"row",children:[(0,i.jsx)("div",{className:"col col-auto mb-3",style:{maxWidth:"150px"},children:(0,i.jsx)("img",{src:null==m?void 0:m.img,alt:"",className:"object-fit-cover w-100 h-auto",style:{minWidth:"70px"}})}),(0,i.jsxs)("div",{className:"col w-75",style:{minWidth:"240px"},children:[(0,i.jsx)("h2",{children:null==m?void 0:m.titleReview}),(0,i.jsx)("h4",{children:null==m?void 0:m.titleItem}),(0,i.jsxs)("p",{children:["Category:\xa0",null==m?void 0:m.category.name]}),(0,i.jsx)("p",{children:null==m?void 0:null===(s=m.tags)||void 0===s?void 0:s.map(e=>{})}),(0,i.jsxs)("p",{children:["Author rate: ",null==m?void 0:m.rating]}),(0,i.jsxs)("div",{className:"row",children:[(0,i.jsxs)("p",{className:"col col-auto me-auto",children:["Likes: ",null==m?void 0:m.likes.length]}),(0,i.jsxs)("p",{className:"col col-auto",children:["Review written by\xa0",(0,i.jsx)(a(),{href:"/profile/".concat(null==m?void 0:null===(n=m.author)||void 0===n?void 0:n._id),className:"text-primary",children:null==m?void 0:null===(l=m.author)||void 0===l?void 0:l.name})]})]})]})]}),(0,i.jsx)("h4",{children:"Review:"}),(0,i.jsx)(y.D,{className:"mt-4",children:null==m?void 0:m.desc}),(0,i.jsx)(N,{likes:o,id:r}),(0,i.jsx)("hr",{className:"w-100"}),(0,i.jsxs)("div",{children:[(0,i.jsx)(f,{id:r}),(0,i.jsx)(j,{id:r})]})]}))}},1512:function(e,s,n){"use strict";n.d(s,{Z:function(){return a}});var i=n(7437),l=n(9639);function a(){return(0,i.jsx)("div",{className:"w-100 h-100 position-absolute z-2 d-flex justify-content-center align-items-center",children:(0,i.jsxs)("div",{className:"py-4 px-5 bg-primary rounded d-flex justify-content-center align-items-center",children:[(0,i.jsx)(l.Z,{animation:"border",variant:"light"}),"\xa0",(0,i.jsx)("p",{className:"m-0 text-light",children:"Loading... Please wait"})]})})}}},function(e){e.O(0,[676,504,749,222,883,279,471,333,588,615,443,971,596,744],function(){return e(e.s=6926)}),_N_E=e.O()}]);