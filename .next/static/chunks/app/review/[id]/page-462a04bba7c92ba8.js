(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[536],{6926:function(e,s,n){Promise.resolve().then(n.bind(n,5371))},5371:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return Z}});var a=n(7437),l=n(1396),i=n.n(l),r=n(4850),t=n(6716),c=n(1279),o=n(1988),d=n(2759),m=n(4883),h=n(2265),u=n(2749),x=n(9222),v=n(6525);function j(e){let{id:s}=e,{data:n,isLoading:l,error:o}=(0,v.ZP)("/api/comment",async()=>{let e=await x.Z.get("/api/comment/".concat(s));return e.data},{refreshInterval:10}),{data:d}=(0,u.useSession)(),[j,p]=(0,h.useState)(""),[g,N]=(0,h.useState)("");if(o)return console.log(o),(0,a.jsx)("p",{children:"Something went wrong. Try to reload page"});if(l)return(0,a.jsx)("p",{children:"Loading comments..."});if((null==n?void 0:n.length)===0)return(0,a.jsx)("div",{className:"shadow py-5 px-1 rounded",children:(0,a.jsx)("h5",{className:"m-0 ms-5",children:"No comments yet"})});let w=(e,s)=>{p(e),N(s)},f=async()=>{N(""),p("")},y={comment:g,reviewId:s,authorId:null==d?void 0:d.user.id},Z=async()=>{await x.Z.post("/api/comment/edit/".concat(j),y),N(""),p("")},b=async e=>{let s=await x.Z.delete("/api/comment/delete/".concat(e));console.log(s),N(""),p("")};return(0,a.jsxs)("div",{className:"shadow rounded p-3",children:[(0,a.jsx)("p",{className:"px-3",children:(0,a.jsxs)("strong",{children:[null==n?void 0:n.length," Comments"]})}),(0,a.jsxs)("div",{className:"px-3",children:[(0,a.jsx)("h4",{className:"mb-4",children:"User comments"}),(0,a.jsx)("div",{className:"px-3",children:null==n?void 0:n.map(e=>{var s,n,l;return(0,a.jsxs)("div",{className:"mb-5 row",children:[(0,a.jsxs)("div",{className:"col",children:[(0,a.jsxs)("div",{className:"row",children:[(0,a.jsx)(i(),{href:"/profile/".concat(null===(s=e.authorId)||void 0===s?void 0:s._id),className:"col text-decoration-none pt-2",children:(0,a.jsx)("strong",{children:null===(n=e.authorId)||void 0===n?void 0:n.name})}),(null==d?void 0:d.user.id)===(null===(l=e.authorId)||void 0===l?void 0:l._id)&&(0,a.jsxs)(r.Z,{className:"col col-auto",children:[(0,a.jsx)(r.Z.Toggle,{variant:"outline-secondary",id:"dropdown-basic",children:(0,a.jsx)(c.G,{icon:"fa-solid fa-bars",className:"me-1"})}),(0,a.jsxs)(r.Z.Menu,{children:[(0,a.jsx)(r.Z.Item,{onClick:()=>w(e._id,e.comment),children:"Edit"}),(0,a.jsx)(r.Z.Divider,{}),(0,a.jsx)(r.Z.Item,{className:"text-danger",onClick:()=>b(e._id),children:"Delete"})]})]})]}),(0,a.jsx)("p",{className:"mt-3 mb-3",children:e.comment}),j===e._id&&(0,a.jsxs)(m.Z.Group,{className:"mb-3",controlId:"desc",children:[(0,a.jsxs)(m.Z.Label,{className:"d-flex justify-content-between align-items-center",children:[(0,a.jsx)("strong",{children:"Edit comment"}),(0,a.jsxs)(t.Z,{variant:"danger",onClick:f,children:[(0,a.jsx)(c.G,{icon:"fa-solid fa-xmark"})," Close"]})]}),(0,a.jsx)(m.Z.Control,{name:"comment",value:g,as:"textarea",className:"mb-3",rows:3,style:{resize:"none"},maxLength:400,placeholder:"Enter your comment",onChange:e=>N(e.target.value)}),(0,a.jsx)(t.Z,{variant:"primary",onClick:Z,children:"Edit comment"})]})]}),(0,a.jsx)("hr",{})]})})})]})]})}o.vI.add(d.xiG);var p=n(7188),g=n(517);function N(e){let{id:s,likes:n}=e,{data:l}=(0,u.useSession)(),i=async()=>{await x.Z.post("/api/review/like/".concat(s),{userId:null==l?void 0:l.user.id})},r=null==n?void 0:n.includes(null==l?void 0:l.user.id);return(0,a.jsx)("div",{className:"d-flex",children:l?(0,a.jsxs)(t.Z,{className:"ms-auto",onClick:i,children:[!r&&(0,a.jsxs)("span",{children:[(0,a.jsx)(c.G,{icon:p.m6i})," like"]}),r&&(0,a.jsxs)("span",{children:[(0,a.jsx)(c.G,{icon:d.m6i})," liked"]})]}):(0,a.jsx)(g.Z,{href:"/login",className:"ms-auto p-2 px-3 rounded bg-primary",children:"Login to like this review"})})}function w(e){let{id:s}=e,[n,l]=(0,h.useState)(""),{data:r}=(0,u.useSession)(),c={comment:n,reviewId:s,authorId:null==r?void 0:r.user.id},o=async()=>{await x.Z.post("/api/comment/".concat(s),c),l("")};return(0,a.jsxs)("div",{className:"shadow p-3 rounded mb-3",children:[r&&(0,a.jsxs)(m.Z.Group,{className:"mb-3 p-3",controlId:"desc",children:[(0,a.jsx)(m.Z.Label,{children:"Your comment"}),(0,a.jsx)(m.Z.Control,{name:"commentValue",value:n,as:"textarea",className:"mb-3",rows:3,style:{resize:"none"},maxLength:400,placeholder:"Enter your comment",onChange:e=>l(e.target.value)}),(0,a.jsx)(t.Z,{variant:"primary",onClick:o,children:"Send comment"})]}),!r&&(0,a.jsxs)("div",{className:"p-3 d-flex me-5",children:[(0,a.jsx)("p",{className:"m-0",children:"Only registered users can leave a comment."}),"\xa0",(0,a.jsx)(i(),{href:"/register",className:"nav-link text-primary",children:(0,a.jsx)("strong",{children:"Sign up"})}),(0,a.jsx)("p",{className:"m-0",children:"\xa0or\xa0"}),(0,a.jsx)(i(),{href:"/login",className:"nav-link text-primary",children:(0,a.jsx)("strong",{children:"Login"})})]})]})}var f=n(4033),y=n(9588);function Z(e){var s,n;let{params:l}=e,{id:r}=l,t=(0,f.useRouter)(),[c,o]=(0,h.useState)(),[d,m]=(0,h.useState)([]),{data:u,error:p,isLoading:g}=(0,v.ZP)("/api/review/".concat(r),async()=>{let e=await x.Z.get("/api/review/".concat(r));return o(e.data.likes),m(JSON.parse(JSON.stringify(e.data.tags))),e.data},{refreshInterval:100});return g?(0,a.jsx)("p",{children:"Loading..."}):p?(console.log(p),(0,a.jsx)("p",{children:"Something went wrong. Try to reload page"})):(u||t.push("/"),(0,a.jsxs)("div",{className:"mb-5",children:[(0,a.jsxs)("div",{className:"row",children:[(0,a.jsx)("div",{className:"col col-auto mb-3",style:{maxWidth:"150px"},children:(0,a.jsx)("img",{src:null==u?void 0:u.img,alt:"",className:"object-fit-cover w-100 h-auto",style:{minWidth:"70px"}})}),(0,a.jsxs)("div",{className:"col w-75",style:{minWidth:"240px"},children:[(0,a.jsx)("h2",{children:null==u?void 0:u.titleReview}),(0,a.jsx)("h4",{children:null==u?void 0:u.titleItem}),(0,a.jsxs)("p",{children:["Category:\xa0",null==u?void 0:u.category.name]}),(0,a.jsx)("p",{children:null==d?void 0:d.map(e=>{let s=JSON.parse(e);return s.name+" "})}),(0,a.jsxs)("p",{children:["Author rate: ",null==u?void 0:u.rating]}),(0,a.jsxs)("div",{className:"row",children:[(0,a.jsxs)("p",{className:"col col-auto me-auto",children:["Likes: ",null==u?void 0:u.likes.length]}),(0,a.jsxs)("p",{className:"col col-auto",children:["Review written by\xa0",(0,a.jsx)(i(),{href:"/profile/".concat(null==u?void 0:null===(s=u.author)||void 0===s?void 0:s._id),className:"text-primary",children:null==u?void 0:null===(n=u.author)||void 0===n?void 0:n.name})]})]})]})]}),(0,a.jsx)("h4",{children:"Review:"}),(0,a.jsx)(y.D,{className:"mt-4",children:null==u?void 0:u.desc}),(0,a.jsx)(N,{likes:c,id:r}),(0,a.jsx)("hr",{className:"w-100"}),(0,a.jsxs)("div",{children:[(0,a.jsx)(w,{id:r}),(0,a.jsx)(j,{id:r})]})]}))}}},function(e){e.O(0,[676,726,222,749,983,588,279,86,333,850,388,971,596,744],function(){return e(e.s=6926)}),_N_E=e.O()}]);