(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[304],{7724:function(e,t,a){Promise.resolve().then(a.bind(a,7267))},7267:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x}});var s=a(7437),l=a(3075),i=a(6716),n=a(4883),r=a(9576),c=a(553),o=a(2265);a(6282);var d=a(2749),u=a(9222),h=a(4033),m=a(2115);function x(e){let{params:t}=e,a=(0,o.useRef)(null),[x,p]=(0,o.useState)([]);(0,h.useRouter)();let[v,j]=(0,o.useState)(!1),[g,f]=(0,o.useState)(null),[y,b]=(0,o.useState)(),[w,N]=(0,o.useState)([]),[Z,S]=(0,o.useState)(),[C,k]=(0,o.useState)(!1),[_,L]=(0,o.useState)(!1),[R,E]=(0,o.useState)(),[O,G]=(0,o.useState)(),[I,T]=(0,o.useState)([]),[D,J]=(0,o.useState)(0),[A,Y]=(0,o.useState)(),[z,F]=(0,o.useState)(),[P,U]=(0,o.useState)(null),{id:K}=t,{data:V,status:q}=(0,d.useSession)(),B=new FormData;B.append("titleReview",R),B.append("titleItem",O),B.append("category",z),B.append("desc",A),B.append("author",null==V?void 0:V.user.id),B.append("rating",D),B.append("likes",0),B.append("file",P),I.forEach(e=>{B.append("tags",JSON.stringify(e.name))});let H=async e=>{e.preventDefault(),j(!0);try{let e=await u.Z.post("/api/review/add",B,{headers:{"Content-Type":"multipart/form-data","Access-Control-Allow-Origin":"*"}});j(!1),console.log(e)}catch(e){k(e),console.log(e),j(!1)}};return(0,o.useEffect)(()=>{let e=async()=>{try{let e=await u.Z.get("/api/review/".concat(K)).then(e=>e.data);S(e),E(e.titleReview),G(e.titleItem),F(e.category),Y(e.desc),T(e.tags),J(e.rating)}catch(e){k(e)}};e();let t=async()=>{try{let e=await u.Z.get("/api/category").then(e=>e.data);p(e)}catch(e){k(e)}};t();let a=async()=>{try{let e=await u.Z.get("/api/tags").then(e=>e.data);N(e)}catch(e){k(e)}};a()},[]),(0,s.jsxs)("main",{children:[g&&(0,s.jsxs)("div",{className:" position-absolute top-0 start-0 end-0 bottom-0 z-2 bg-body pb-5",children:[(0,s.jsx)(m.Z,{reviewData:body}),(0,s.jsx)(i.Z,{variant:"secondary",className:"mb-5",onClick:e=>f(!1),children:"Close preview"})]}),(0,s.jsx)(n.Z,{onSubmit:H,style:{marginTop:"100px"},children:(0,s.jsxs)("div",{className:"d-flex justify-content-center",children:[(0,s.jsxs)("div",{className:"me-5 mt-2",children:[v&&(0,s.jsx)("p",{children:"Loading..."}),(0,s.jsx)("div",{style:{width:"156px",height:"231px"},className:"mb-4 rounded overflow-hidden border",children:(0,s.jsx)("img",{alt:"",src:null==Z?void 0:Z.img,className:"object-fit-cover",style:{width:"158px",height:"234px",textIndent:"100vw",marginLeft:"-2px",marginTop:"-2px"}})}),(0,s.jsx)("input",{ref:a,type:"file",accept:"image/*",name:"image",id:"selectFile",hidden:!0,onChange:e=>{U(e.target.files[0]),b(URL.createObjectURL(e.target.files[0]))}}),(0,s.jsx)(i.Z,{onClick:()=>{var e;null===(e=a.current)||void 0===e||e.click()},className:"w-100",variant:"primary",children:"Edit image"})]}),(0,s.jsxs)("div",{className:"w-50",children:[(0,s.jsxs)(n.Z.Group,{className:"mb-3",children:[(0,s.jsx)(n.Z.Label,{children:(0,s.jsx)("h2",{children:"Title of review"})}),(0,s.jsx)(n.Z.Control,{type:"text",value:R,name:"titleReview",placeholder:"Enter title of your review",onChange:e=>E(e.target.value)})]}),(0,s.jsxs)(n.Z.Group,{className:"mb-3",children:[(0,s.jsx)(n.Z.Label,{children:(0,s.jsx)("h4",{children:"Title of movie, book, game, etc"})}),(0,s.jsx)(n.Z.Control,{type:"text",value:O,name:"titleItem",placeholder:"Enter title of movie, book, game, etc...",onChange:e=>G(e.target.value)})]}),(0,s.jsxs)(n.Z.Group,{className:"mb-3",children:[(0,s.jsx)(n.Z.Label,{children:"Choice category"}),(0,s.jsx)(l.Z,{children:(0,s.jsx)(n.Z.Select,{name:"category","aria-label":"category",onChange:e=>F(e.target.value),children:x.map(e=>(0,s.jsxs)("option",{selected:e._id===z,value:e._id,children:[e.name,e._id,e.key]},e.key))})})]}),(0,s.jsxs)(n.Z.Group,{className:"mb-3",children:[(0,s.jsx)(n.Z.Label,{children:"Enter tags for your review"}),(0,s.jsx)(c.pY,{id:"basic-typeahead-multiple",labelKey:"name",multiple:!0,onChange:T,options:w,placeholder:"Choose several tags...",selected:I,className:"text-body"})]}),(0,s.jsxs)(n.Z.Group,{className:"mb-3",controlId:"desc",children:[(0,s.jsx)(n.Z.Label,{children:"Your review"}),(0,s.jsx)(n.Z.Control,{name:"desc",as:"textarea",rows:4,value:A,maxLength:4096,placeholder:"Text of review",onChange:e=>Y(e.target.value)})]}),(0,s.jsxs)(n.Z.Group,{className:"mb-4 d-flex flex-column",children:[(0,s.jsx)(n.Z.Label,{children:"Your grade from 0 - 10"}),(0,s.jsx)(r.i,{size:25,iconsCount:10,initialValue:D,onClick:e=>{J(e)}})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(i.Z,{variant:"secondary",className:"me-5",onClick:e=>f(!0),children:"Preview"}),(0,s.jsx)(i.Z,{type:"submit",variant:"primary",className:"shadow-sm",style:{width:"180px"},children:"Submit"}),C&&(0,s.jsx)("p",{className:"text-danger mt-3",children:C.message})]})]})]})})]})}a(2333)},2115:function(e,t,a){"use strict";a.d(t,{Z:function(){return c}});var s=a(7437),l=a(2749),i=a(1396),n=a.n(i),r=a(9588);function c(e){var t,a,i,c,o;let{reviewData:d}=e,u=JSON.parse(JSON.stringify(d.tags)),{data:h,status:m}=(0,l.useSession)();return(0,s.jsxs)("div",{className:"mb-5",children:[(0,s.jsxs)("div",{className:"d-flex",children:[(0,s.jsx)(n(),{href:"/review/".concat(null==d?void 0:d._id),className:"text-decoration-none text-body",children:(0,s.jsx)("div",{className:"me-5 mt-2",children:(0,s.jsx)("img",{src:null==d?void 0:d.img,alt:"",className:"object-fit-cover",style:{width:"156px",height:"231px",background:"red"}})})}),(0,s.jsxs)("div",{className:"w-75",children:[(0,s.jsxs)(n(),{href:"/review/".concat(d._id),className:"text-decoration-none text-body",children:[(0,s.jsx)("h2",{children:null==d?void 0:d.titleReview}),(0,s.jsx)("h4",{children:null==d?void 0:d.titleItem}),(0,s.jsx)("p",{children:null==d?void 0:null===(t=d.category)||void 0===t?void 0:t.name}),(0,s.jsx)("p",{children:u.map(e=>{let t=JSON.parse(e);return t.name+" "})}),(0,s.jsx)(r.D,{children:(null==d?void 0:null===(a=d.desc)||void 0===a?void 0:a.substring(0,200))+"..."}),(0,s.jsxs)("p",{children:["Rate: ",null==d?void 0:d.rating]})]}),(0,s.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,s.jsxs)("p",{children:["Review likes: ",null==d?void 0:d.likes]}),d.author.name&&(0,s.jsxs)("p",{children:["Author: \xa0",(0,s.jsx)(n(),{href:(null==d?void 0:null===(i=d.author)||void 0===i?void 0:i._id)===(null==h?void 0:null===(c=h.user)||void 0===c?void 0:c.id)?"/profile":"/profile/".concat(null==d?void 0:null===(o=d.author)||void 0===o?void 0:o._id),className:"text-primary",children:null==d?void 0:d.author.name})]})]})]})]}),(0,s.jsx)("hr",{className:"w-100"})]})}}},function(e){e.O(0,[726,222,749,588,333,890,841,470,971,596,744],function(){return e(e.s=7724)}),_N_E=e.O()}]);