(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[495],{8897:function(e,t,a){Promise.resolve().then(a.bind(a,2297))},2297:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var l=a(7437),i=a(504),s=a(2759),n=a(2749),r=a(6525),c=a(9222),o=a(4033),d=a(6526),u=a(2265),h=a(3270),x=a(3795);function v(e){let{params:t}=e,[a,v]=(0,u.useState)([]),[p,m]=(0,u.useState)(),[j,g]=(0,u.useState)(""),[b,w]=(0,u.useState)(),{id:Z}=t,{data:f,status:N}=(0,n.useSession)(),y=(0,o.useRouter)();Z===(null==f?void 0:f.user.id)&&y.push("/profile");let{data:S,error:C,isLoading:k}=(0,r.ZP)("/api/profile/".concat(Z),async()=>{let e=await c.Z.get("/api/profile/".concat(Z)),t=await c.Z.get("/api/profile/user/".concat(Z));return v(e.data),m(t.data),e.data},{revalidateOnFocus:!1,revalidateOnMount:!0});if(k)return(0,l.jsx)("p",{children:"Loading..."});if(C)return console.log(C),(0,l.jsx)("p",{children:"Something went wrong. Try to reload page"});let R=[];return null==a||a.filter(e=>{e.likes.length>0&&R.push(...e.likes)}),(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:"row",style:{marginTop:"80px"},children:[(0,l.jsxs)("div",{className:"row",children:[(0,l.jsxs)("h3",{className:"mb-4",children:[null==p?void 0:p.name,"'s profile"]}),(0,l.jsx)("div",{className:"col col-md-3 mb-4",children:(0,l.jsxs)("div",{className:"p-3 shadow rounded",children:[(0,l.jsx)("p",{children:null==p?void 0:p.name}),(0,l.jsx)("p",{children:null==p?void 0:p.email}),(0,l.jsxs)("p",{children:[(0,l.jsxs)("strong",{children:[" ",null==a?void 0:a.length," "]})," reviews"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)(i.G,{icon:s.m6i}),"\xa0",(0,l.jsx)("strong",{children:R.length}),"\xa0likes"]})]})}),(0,l.jsxs)("div",{className:"col",children:[(0,l.jsx)(h.Z,{url:"/api/profile/".concat(Z),getQuery:e=>{g(e)},getReviews:e=>{v(e)}}),(0,l.jsx)(x.Z,{reviews:a,getSort:e=>{w(e)}})]})]}),(0,l.jsxs)("div",{className:"col",style:{minWidth:"70%"},children:[(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsxs)("h3",{children:[null==p?void 0:p.name," reviews"]})}),0===a.length&&(0,l.jsx)("p",{children:"There are no reviews here yet"}),null==b?void 0:b.map(e=>(0,l.jsx)(d.Z,{data:e,id:Z,highlight:j},e._id))]})]})})}},3270:function(e,t,a){"use strict";a.d(t,{Z:function(){return m}});var l=a(7437),i=a(6716),s=a(4883),n=a(9222),r=a(6525),c=a(3075);function o(e){let{url:t,getCategory:a}=e,{data:i,error:o,isLoading:d}=(0,r.ZP)("http://localhost:3000/api/category",async()=>{let e=await n.Z.get("/api/category");return e.data},{revalidateOnMount:!0,revalidateOnFocus:!1});return(0,l.jsxs)(s.Z.Group,{className:"col col-auto mb-3",children:[(0,l.jsx)(s.Z.Label,{children:"Choice category"}),(0,l.jsx)(c.Z,{children:(0,l.jsxs)(s.Z.Select,{name:"category",placeholder:"Choice category","aria-label":"category",onChange:e=>{a(e.target.value)},children:[(0,l.jsx)("option",{value:"",children:"All categories"}),null==i?void 0:i.map(e=>(0,l.jsx)("option",{value:e.name,children:e.name},e._id))]})})]})}var d=a(504),u=a(2265),h=a(2759);function x(e){let{url:t,getSearch:a}=e,[n,r]=(0,u.useState)("");return a(n),(0,l.jsxs)(s.Z.Group,{className:"col col-auto mb-3",children:[(0,l.jsx)(s.Z.Label,{children:"Enter review title, text, author or comment"}),(0,l.jsxs)(c.Z,{children:[(0,l.jsx)(c.Z.Text,{className:"text-secondary",children:(0,l.jsx)(d.G,{icon:h.Y$T})}),(0,l.jsx)(s.Z.Control,{placeholder:"Find a review",value:n,"aria-label":"Find a review","aria-describedby":"basic-addon2",onChange:e=>r(e.target.value)}),(0,l.jsx)(i.Z,{variant:"outline-secondary",className:"input-group-text ",id:"basic-addon3",onClick:()=>{r("")},children:(0,l.jsx)(d.G,{icon:h.g82})})]})]})}a(6282);var v=a(3538);function p(e){let{url:t,getTags:a}=e,[i,c]=(0,u.useState)([]),[o,d]=(0,u.useState)([]),{data:h,error:x,isLoading:p}=(0,r.ZP)("http://localhost:3000/api/tags",async()=>{let e=await n.Z.get("/api/tags");return d(e.data.map(e=>e.name)),e.data},{revalidateOnMount:!0,revalidateOnFocus:!1});return a(i),(0,l.jsxs)(s.Z.Group,{className:"col col-auto mb-3",children:[(0,l.jsx)(s.Z.Label,{children:"Choice tags"}),(0,l.jsx)(v.pY,{id:"basic-typeahead-multiple",labelKey:"name",multiple:!0,onChange:c,options:o,placeholder:"Choose several tags...",selected:i,className:"text-body"})]})}function m(e){let{url:t,getReviews:a,getQuery:r}=e,[c,d]=(0,u.useState)(""),[h,v]=(0,u.useState)(""),[m,j]=(0,u.useState)([]),g=async e=>{e.preventDefault();let l=await n.Z.get("http://localhost:3000"+"".concat(t,"?category=").concat(c,"&search=").concat(h,"&tags=").concat(m));a(l.data),r(h)};return(0,l.jsx)("div",{className:"col col-auto mb-3",children:(0,l.jsxs)(s.Z,{onSubmit:g,className:"row",children:[(0,l.jsx)(p,{getTags:e=>{j(e)}}),(0,l.jsx)(o,{getCategory:e=>{d(e)}}),(0,l.jsx)(x,{getSearch:e=>{v(e)}}),(0,l.jsx)(s.Z.Group,{children:(0,l.jsx)(i.Z,{variant:"primary",type:"submit",children:"Search"})})]})})}},6526:function(e,t,a){"use strict";a.d(t,{Z:function(){return u}});var l=a(7437),i=a(9222),s=a(2749),n=a(1396),r=a.n(n),c=a(2615),o=a(8829),d=a.n(o);function u(e){var t,a;let{data:n,id:o,highlight:u}=e,{data:h,status:x}=(0,s.useSession)();return(0,l.jsxs)("div",{className:"mb-5",children:[(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:"row",children:[(0,l.jsxs)(r(),{href:"/review/".concat(null==n?void 0:n._id),className:"col text-decoration-none text-body d-flex ",children:[(0,l.jsx)("div",{className:"mt-2 me-3",style:{maxWidth:"150px"},children:(0,l.jsx)("img",{src:null==n?void 0:n.img,alt:"",className:"object-fit-cover w-100 h-auto",style:{minWidth:"70px"}})}),(0,l.jsxs)("div",{style:{minWidth:"180px"},children:[(0,l.jsx)("h2",{children:null==n?void 0:n.titleReview}),(0,l.jsx)("h4",{children:null==n?void 0:n.titleItem}),(0,l.jsx)("p",{children:null==n?void 0:null===(t=n.category)||void 0===t?void 0:t.name}),(0,l.jsx)("p",{children:null==n?void 0:n.tags.map(e=>(0,l.jsx)("span",{className:"rbt-token p-1",children:e+" "}))}),(0,l.jsx)("div",{className:"mb-3",children:(0,l.jsx)(d(),{highlightClassName:"bg-warning",searchWords:[u],autoEscape:!0,textToHighlight:(null==n?void 0:null===(a=n.desc)||void 0===a?void 0:a.substring(0,200))+"..."})}),(0,l.jsxs)("p",{children:["Rate: ",null==n?void 0:n.rating]}),(0,l.jsx)("div",{className:"d-flex justify-content-between",children:(0,l.jsxs)("p",{children:["Review likes: ",null==n?void 0:n.likes.length]})})]})]}),(o===(null==h?void 0:h.user.id)||(null==h?void 0:h.user.admin))&&(0,l.jsxs)(c.Z,{className:"col col-auto",children:[(0,l.jsx)(c.Z.Toggle,{variant:"secondary",id:"dropdown-basic",children:"More actions"}),(0,l.jsxs)(c.Z.Menu,{children:[(0,l.jsx)(c.Z.Item,{href:"/review/edit/".concat(null==n?void 0:n._id),children:"Edit"}),(0,l.jsx)(c.Z.Divider,{}),(0,l.jsx)(c.Z.Item,{className:"text-danger",onClick:()=>i.Z.delete("/api/review/delete/".concat(null==n?void 0:n._id)),children:"Delete"})]})]})]})}),(0,l.jsx)("hr",{className:"w-100"})]})}},3795:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var l=a(7437),i=a(2265),s=a(4883);function n(e){let{reviews:t,getSort:a}=e,[n,r]=(0,i.useState)("");return""===n&&a(t),(0,l.jsx)("div",{className:"mb-3 col col-auto",children:(0,l.jsxs)(s.Z.Group,{children:[(0,l.jsx)(s.Z.Label,{children:"Sort by"}),(0,l.jsxs)(s.Z.Select,{name:"sort",placeholder:"Sort by","aria-label":"Sort",onChange:e=>{let l=e.target.value;r(l),("title-descending"===l||"title-ascending"===l)&&("title-descending"===l&&t.sort((e,t)=>{let a=e.titleReview.toUpperCase(),l=t.titleReview.toUpperCase();return a<l?1:a>l?-1:0}),"title-ascending"===l&&t.sort((e,t)=>{let a=e.titleReview.toUpperCase(),l=t.titleReview.toUpperCase();return a>l?1:a<l?-1:0}),a(t));let i=t.map(e=>({...e,createdAt:new Date(e.createdAt)}));"date-last"===l&&i.sort((e,t)=>Number(t.createdAt)-Number(e.createdAt)),"date-new"===l&&i.sort((e,t)=>Number(e.createdAt)-Number(t.createdAt)),a(i)},value:n,children:[(0,l.jsx)("option",{value:"",children:"Select Sort Type"}),(0,l.jsx)("option",{value:"title-ascending",children:"Review title ascending"}),(0,l.jsx)("option",{value:"title-descending",children:"Review title descending"}),(0,l.jsx)("option",{value:"date-last",children:"Date latest"}),(0,l.jsx)("option",{value:"date-new",children:"Date oldest"})]})]})})}},4033:function(e,t,a){e.exports=a(8165)}},function(e){e.O(0,[676,302,222,396,883,504,471,753,333,615,829,971,596,744],function(){return e(e.s=8897)}),_N_E=e.O()}]);