(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[304],{7724:function(e,t,a){Promise.resolve().then(a.bind(a,7267))},7267:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var s=a(7437),i=a(3075),l=a(6716),n=a(4883),r=a(9576),o=a(3538),c=a(2265);a(6282);var d=a(2749),u=a(9222),m=a(4033),h=a(2115);a(2333);var x=a(1512);function v(e){let{params:t}=e,{id:a}=t,v=(0,c.useRef)(null),[p,j]=(0,c.useState)([]),g=(0,m.useRouter)(),[f,b]=(0,c.useState)(!1),[y,w]=(0,c.useState)(null),[N,Z]=(0,c.useState)(),[S,C]=(0,c.useState)([]),[k,_]=(0,c.useState)(),[L,R]=(0,c.useState)(!1),[E,O]=(0,c.useState)(),[G,D]=(0,c.useState)(),[I,J]=(0,c.useState)([]),[W,T]=(0,c.useState)(0),[z,A]=(0,c.useState)(),[Y,F]=(0,c.useState)(),[P,U]=(0,c.useState)(null),{data:H,status:K}=(0,d.useSession)(),V=new FormData;V.append("titleReview",E),V.append("titleItem",G),V.append("category",Y),V.append("desc",z),V.append("rating",W),V.append("likes",0),V.append("file",P),I.forEach(e=>{V.append("tags",JSON.stringify(e))});let q=async e=>{e.preventDefault(),b(!0);try{let e=await u.Z.post("/api/review/edit/".concat(a),V,{headers:{"Content-Type":"multipart/form-data","Access-Control-Allow-Origin":"*"}});b(!1),201===e.status&&g.push("/")}catch(e){R(e),console.log(e),b(!1)}};return(0,c.useEffect)(()=>{let e=async()=>{b(!0);try{let e=await u.Z.get("/api/category").then(e=>e.data);j(e);let t=await u.Z.get("/api/tags").then(e=>e.data);C(t);let s=await u.Z.get("/api/review/".concat(a)).then(e=>e.data);_(s),O(s.titleReview),D(s.titleItem),F(s.category._id),A(s.desc),J(s.tags.map(e=>JSON.parse(e))),T(s.rating),Z(s.img),b(!1)}catch(e){console.log(e),R(e.message),b(!1)}};e()},[]),(0,s.jsxs)("main",{children:[y&&(0,s.jsxs)("div",{className:"container position-absolute top-0 start-0 end-0 bottom-0 z-2 bg-body pb-5",children:[(0,s.jsx)(h.Z,{reviewData:body}),(0,s.jsx)(l.Z,{variant:"secondary",className:"mb-5",onClick:e=>w(!1),children:"Close preview"})]}),(0,s.jsxs)(n.Z,{onSubmit:q,children:[f&&(0,s.jsx)(x.Z,{}),(0,s.jsxs)("div",{className:"row",children:[(0,s.jsxs)("div",{className:"col col-auto mt-2 mb-4",children:[(0,s.jsx)("div",{style:{maxWidth:"150px",minHeight:"200px"},className:"mb-4 p-2 rounded overflow-hidden border",children:(0,s.jsx)("img",{alt:"",src:N,className:"object-fit-cover w-100 h-auto"})}),(0,s.jsx)("input",{ref:v,type:"file",accept:"image/*",name:"image",id:"selectFile",hidden:!0,onChange:e=>{U(e.target.files[0]),Z(URL.createObjectURL(e.target.files[0]))}}),(0,s.jsx)(l.Z,{onClick:()=>{var e;null===(e=v.current)||void 0===e||e.click()},className:"w-100",variant:"primary",children:"Edit image"})]}),(0,s.jsxs)("div",{className:"col",style:{minWidth:"80%"},children:[(0,s.jsxs)(n.Z.Group,{className:"mb-3",children:[(0,s.jsx)(n.Z.Label,{children:(0,s.jsx)("h2",{children:"Title of review"})}),(0,s.jsx)(n.Z.Control,{type:"text",value:E,name:"titleReview",placeholder:"Enter title of your review",onChange:e=>O(e.target.value)})]}),(0,s.jsxs)(n.Z.Group,{className:"mb-3",children:[(0,s.jsx)(n.Z.Label,{children:(0,s.jsx)("h4",{children:"Title of movie, book, game, etc"})}),(0,s.jsx)(n.Z.Control,{type:"text",value:G,name:"titleItem",placeholder:"Enter title of movie, book, game, etc...",onChange:e=>D(e.target.value)})]}),(0,s.jsxs)(n.Z.Group,{className:"mb-3",children:[(0,s.jsx)(n.Z.Label,{children:"Choice category"}),(0,s.jsx)(i.Z,{children:(0,s.jsx)(n.Z.Select,{name:"category","aria-label":"category",onChange:e=>F(e.target.value),children:p.map(e=>(0,s.jsx)("option",{selected:e._id===Y,value:e._id,children:e.name},e.key))})})]}),(0,s.jsxs)(n.Z.Group,{className:"mb-3",children:[(0,s.jsx)(n.Z.Label,{children:"Enter tags for your review"}),(0,s.jsx)(o.pY,{id:"basic-typeahead-multiple",labelKey:"name",multiple:!0,onChange:J,options:S,placeholder:"Choose several tags...",selected:I,className:"text-body"})]}),(0,s.jsxs)(n.Z.Group,{className:"mb-3",controlId:"desc",children:[(0,s.jsx)(n.Z.Label,{children:"Your review"}),(0,s.jsx)(n.Z.Control,{name:"desc",as:"textarea",rows:4,value:z,maxLength:4096,placeholder:"Text of review",onChange:e=>A(e.target.value)})]}),(0,s.jsxs)(n.Z.Group,{className:"mb-4 d-flex flex-column",children:[(0,s.jsx)(n.Z.Label,{children:"Your grade from 0 - 10"}),(0,s.jsx)(r.i,{size:25,iconsCount:10,initialValue:W,onClick:e=>{T(e)}})]}),L&&(0,s.jsx)("p",{className:"text-danger",children:L.message}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.Z,{variant:"secondary",className:"me-3 mb-3",onClick:e=>w(!0),children:"Preview"}),(0,s.jsx)(l.Z,{type:"submit",variant:"primary",className:"mb-3 shadow-sm",style:{width:"180px"},children:"Submit"}),L&&(0,s.jsx)("p",{className:"text-danger mt-3",children:L.message})]})]})]})]})]})}},1512:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var s=a(7437);function i(){return(0,s.jsx)("div",{className:"w-100 h-100 position-absolute z-2 d-flex justify-content-center align-items-center",children:(0,s.jsx)("div",{className:"w-75 py-4 px-5 bg-primary rounded d-flex justify-content-center align-items-center",children:(0,s.jsx)("p",{className:"m-0 text-light",children:"Loading...please wait"})})})}},2115:function(e,t,a){"use strict";a.d(t,{Z:function(){return c}});var s=a(7437),i=a(2749),l=a(1396),n=a.n(l),r=a(2265),o=a(9588);function c(e){var t,a,l,c,d,u;let{reviewData:m}=e,[h,x]=(0,r.useState)(JSON.parse(JSON.stringify(null==m?void 0:m.tags))),{data:v,status:p}=(0,i.useSession)();return(0,s.jsxs)("div",{className:"mb-5",children:[(0,s.jsxs)("div",{className:"d-flex",children:[(0,s.jsx)(n(),{href:"/review/".concat(null==m?void 0:m._id),className:"text-decoration-none text-body mt-2 me-3",children:(0,s.jsx)("div",{style:{maxWidth:"150px"},children:(0,s.jsx)("img",{src:null==m?void 0:m.img,alt:"",className:"object-fit-cover w-100 h-auto",style:{minWidth:"70px"}})})}),(0,s.jsxs)("div",{className:"w-75",style:{minWidth:"180px"},children:[(0,s.jsxs)(n(),{href:"/review/".concat(m._id),className:"text-decoration-none text-body",children:[(0,s.jsx)("h2",{children:null==m?void 0:m.titleReview}),(0,s.jsx)("h4",{children:null==m?void 0:m.titleItem}),(0,s.jsx)("p",{children:null==m?void 0:null===(t=m.category)||void 0===t?void 0:t.name}),(0,s.jsx)("p",{children:null==h?void 0:h.map(e=>{let t=JSON.parse(e);return t.name+" "})}),(0,s.jsx)(o.D,{children:(null==m?void 0:null===(a=m.desc)||void 0===a?void 0:a.substring(0,200))+"..."}),(0,s.jsxs)("p",{children:["Rate: ",null==m?void 0:m.rating]})]}),(0,s.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,s.jsxs)("p",{children:["Review likes: ",null==m?void 0:m.likes]}),(null==m?void 0:null===(l=m.author)||void 0===l?void 0:l.name)&&(0,s.jsxs)("p",{children:["Author: \xa0",(0,s.jsx)(n(),{href:(null==m?void 0:null===(c=m.author)||void 0===c?void 0:c._id)===(null==v?void 0:null===(d=v.user)||void 0===d?void 0:d.id)?"/profile":"/profile/".concat(null==m?void 0:null===(u=m.author)||void 0===u?void 0:u._id),className:"text-primary",children:null==m?void 0:m.author.name})]})]})]})]}),(0,s.jsx)("hr",{className:"w-100"})]})}}},function(e){e.O(0,[726,222,153,333,588,471,334,971,596,744],function(){return e(e.s=7724)}),_N_E=e.O()}]);