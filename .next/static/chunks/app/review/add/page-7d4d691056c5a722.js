(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[154],{4974:function(e,t,l){Promise.resolve().then(l.bind(l,2976))},2976:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return p}});var s=l(7437);l(6282);var a=l(3075),i=l(6716),n=l(4883),o=l(3538),r=l(9576),c=l(2265),d=l(2749),u=l(9222),h=l(4033),m=l(2115),x=l(1512);function p(){let e=(0,h.useRouter)(),t=(0,c.useRef)(null),[l,p]=(0,c.useState)([]),[v,j]=(0,c.useState)(!1),[g,f]=(0,c.useState)(null),[b,y]=(0,c.useState)(),[N,w]=(0,c.useState)(),[Z,S]=(0,c.useState)([]),[C,k]=(0,c.useState)([]),[L,_]=(0,c.useState)(),[O,R]=(0,c.useState)(),[D,E]=(0,c.useState)(0),[G,I]=(0,c.useState)(),[T,W]=(0,c.useState)(),[A,J]=(0,c.useState)(null),[q,z]=(0,c.useState)(),{data:F,status:P}=(0,d.useSession)(),Y={titleReview:L,titleItem:O,category:T,tags:Z.map(e=>JSON.stringify(e)),desc:G,likes:[],author:null==F?void 0:F.user.id,rating:D,img:b},U=new FormData;U.append("titleReview",L),U.append("titleItem",O),U.append("category",T),U.append("desc",G),U.append("author",null==F?void 0:F.user.id),U.append("rating",D),U.append("likes",0),U.append("file",A),Z.forEach(e=>{U.append("tags",JSON.stringify(e))});let V=async t=>{if(t.preventDefault(),N){j(!0);try{let t=await u.Z.post("/api/review/add",U,{headers:{"Content-Type":"multipart/form-data","Access-Control-Allow-Origin":"*"}}),l=await u.Z.post("/api/tags",Z);console.log(l),console.log(t),j(!1),201===t.status&&e.push("/")}catch(e){z(e),console.log(e),j(!1)}}};return(0,c.useEffect)(()=>{let e=async()=>{try{let e=await u.Z.get("/api/category").then(e=>e.data);p(e)}catch(e){z(e),console.log(e)}};e();let t=async()=>{try{let e=await u.Z.get("/api/tags").then(e=>e.data);k(e)}catch(e){z(e),console.log(e)}};t()},[]),(0,s.jsxs)("main",{children:[g&&(0,s.jsxs)("div",{className:"container position-absolute top-0 start-0 end-0 bottom-0 z-2 bg-body pb-5",children:[(0,s.jsx)(m.Z,{reviewData:Y}),(0,s.jsx)(i.Z,{variant:"secondary",className:"mb-5",onClick:e=>f(!1),children:"Close preview"})]}),(0,s.jsxs)(n.Z,{onSubmit:V,children:[v&&(0,s.jsx)(x.Z,{}),(0,s.jsxs)("div",{className:"row",children:[(0,s.jsxs)("div",{className:"col col-auto mt-2 mb-4",children:[(0,s.jsx)("div",{style:{maxWidth:"150px",minHeight:"200px"},className:"mb-4 p-2 rounded overflow-hidden border",children:(0,s.jsx)("img",{alt:"",src:b,className:"object-fit-cover w-100 h-auto"})}),(0,s.jsx)("input",{ref:t,type:"file",accept:"image/*",name:"image",id:"selectFile",hidden:!0,onChange:e=>{J(e.target.files[0]),y(URL.createObjectURL(e.target.files[0]))}}),(0,s.jsx)(i.Z,{onClick:()=>{var e;null===(e=t.current)||void 0===e||e.click()},className:"w-100",variant:"primary",children:"Choose image"})]}),(0,s.jsxs)("div",{className:"col",style:{minWidth:"80%"},children:[(0,s.jsxs)(n.Z.Group,{className:"mb-3",children:[(0,s.jsx)(n.Z.Label,{children:(0,s.jsx)("h2",{children:"Title of review"})}),(0,s.jsx)(n.Z.Control,{required:!0,type:"text",name:"titleReview",placeholder:"Enter title of your review",onChange:e=>_(e.target.value)})]}),(0,s.jsxs)(n.Z.Group,{className:"mb-3",children:[(0,s.jsx)(n.Z.Label,{children:(0,s.jsx)("h4",{children:"Title of movie, book, game, etc"})}),(0,s.jsx)(n.Z.Control,{required:!0,type:"text",name:"titleItem",placeholder:"Enter title of movie, book, game, etc...",onChange:e=>R(e.target.value)})]}),(0,s.jsxs)(n.Z.Group,{className:"mb-3",children:[(0,s.jsx)(n.Z.Label,{children:"Choice category"}),(0,s.jsx)(a.Z,{children:(0,s.jsxs)(n.Z.Select,{required:!0,name:"category","aria-label":"category",onChange:e=>W(e.target.value),children:[(0,s.jsx)("option",{selected:!0,disabled:!0,children:"Choose category"}),l.map(e=>(0,s.jsx)("option",{value:e._id,children:e.name},e.key))]})})]}),(0,s.jsxs)(n.Z.Group,{className:"mb-3",children:[(0,s.jsx)(n.Z.Label,{children:"Enter tags for your review"}),(0,s.jsx)(o.pY,{id:"basic-typeahead-multiple",labelKey:"name",allowNew:!0,multiple:!0,onChange:S,options:C,placeholder:"Choose several tags...",selected:Z,className:"text-body"})]}),(0,s.jsxs)(n.Z.Group,{className:"mb-3",controlId:"desc",children:[(0,s.jsx)(n.Z.Label,{children:"Your review"}),(0,s.jsx)(n.Z.Control,{name:"desc",as:"textarea",rows:4,required:!0,maxLength:4096,placeholder:"Text of review",onChange:e=>I(e.target.value)})]}),(0,s.jsxs)(n.Z.Group,{className:"mb-4 d-flex flex-column",children:[(0,s.jsx)(n.Z.Label,{children:"Your grade from 1 - 10"}),(0,s.jsx)(r.i,{size:25,iconsCount:10,onClick:e=>{E(e)}})]}),q&&(0,s.jsx)("p",{className:"text-danger",children:q.message}),!1==N&&(0,s.jsx)("p",{className:"text-danger",children:"Fill all fields"}),(0,s.jsxs)("div",{className:"mb-5",children:[(0,s.jsx)(i.Z,{variant:"secondary",className:"me-3 mb-3",onClick:()=>{f(!0),window.scrollTo({top:0,behavior:"smooth"})},children:"Preview"}),(0,s.jsx)(i.Z,{type:"submit",variant:"primary",className:"shadow-sm mb-3",style:{width:"180px",minWidth:"120px"},onClick:()=>{w(!1),console.log("NOT VALID"),""!=l&&Z.length>0&&D>0&&null!=A&&""!=L&&""!=O&&""!=G&&(w(!0),console.log("VALID"))},children:"Submit"})]})]})]})]})]})}},1512:function(e,t,l){"use strict";l.d(t,{Z:function(){return a}});var s=l(7437);function a(){return(0,s.jsx)("div",{className:"w-100 h-100 position-absolute z-2 d-flex justify-content-center align-items-center",children:(0,s.jsx)("div",{className:"py-4 px-5 bg-primary rounded d-flex justify-content-center align-items-center",children:(0,s.jsx)("p",{className:"m-0 text-light",children:"Loading... Please wait"})})})}},2115:function(e,t,l){"use strict";l.d(t,{Z:function(){return c}});var s=l(7437),a=l(2749),i=l(1396),n=l.n(i),o=l(2265),r=l(9588);function c(e){var t,l,i,c,d,u,h;let{main:m,reviewData:x}=e,[p,v]=(0,o.useState)(JSON.parse(JSON.stringify(null==x?void 0:x.tags))),{data:j,status:g}=(0,a.useSession)();return console.log(x),(0,s.jsxs)("div",{className:"mb-5",children:[(0,s.jsxs)("div",{className:"d-flex",children:[(0,s.jsx)(n(),{href:"/review/".concat(null==x?void 0:x._id),className:"text-decoration-none text-body mt-2 me-3",children:(0,s.jsx)("div",{style:{maxWidth:"150px"},children:(0,s.jsx)("img",{src:null==x?void 0:x.img,alt:"",className:"object-fit-cover w-100 h-auto",style:{minWidth:"70px"}})})}),(0,s.jsxs)("div",{className:"w-75",style:{minWidth:"180px"},children:[(0,s.jsxs)(n(),{href:"/review/".concat(x._id),className:"text-decoration-none text-body",children:[(0,s.jsx)("h2",{children:null==x?void 0:x.titleReview}),(0,s.jsx)("h4",{children:null==x?void 0:x.titleItem}),(0,s.jsx)("p",{children:null==x?void 0:null===(t=x.category)||void 0===t?void 0:t.name}),(0,s.jsx)("p",{children:null==p?void 0:p.map(e=>{let t=JSON.parse(e);return t.name+" "})}),m?(0,s.jsx)(r.D,{children:(null==x?void 0:null===(l=x.desc)||void 0===l?void 0:l.substring(0,200))+"..."}):(0,s.jsx)(r.D,{children:null==x?void 0:x.desc}),(0,s.jsxs)("p",{children:["Rate: ",null==x?void 0:x.rating]})]}),(0,s.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,s.jsxs)("p",{children:["Review likes: ",null==x?void 0:null===(i=x.likes)||void 0===i?void 0:i.length]}),(null==x?void 0:null===(c=x.author)||void 0===c?void 0:c.name)&&(0,s.jsxs)("p",{children:["Author: \xa0",(0,s.jsx)(n(),{href:(null==x?void 0:null===(d=x.author)||void 0===d?void 0:d._id)===(null==j?void 0:null===(u=j.user)||void 0===u?void 0:u.id)?"/profile":"/profile/".concat(null==x?void 0:null===(h=x.author)||void 0===h?void 0:h._id),className:"text-primary",children:null==x?void 0:x.author.name})]})]})]})]}),(0,s.jsx)("hr",{className:"w-100"})]},x._id)}}},function(e){e.O(0,[726,222,749,983,588,86,465,971,596,744],function(){return e(e.s=4974)}),_N_E=e.O()}]);